{"version":3,"sources":["pages/admin/children/resources-admin/cate.jsx"],"names":["ResourcesCate","props","handleInputChange","e","addResCateValue","target","value","setState","handleOpenOrCloseModal","type","isModalVisible","handleDeleteResourcesCate","resourcesCate","cate","confirm","content","name","onOk","DeleteResourcesCate","DeleteResource","cateName","a","find","item","children","length","warning","reqResourcesDeleteCate","res","code","success","msg","QcEventEmitter","emit","resource","id","reqDeleteResources","handleAddResourcesCate","state","reqAddResourcesCate","columns","title","dataIndex","width","render","danger","onClick","this","className","bordered","dataSource","rowKey","visible","onCancel","okText","cancelText","onChange","Component"],"mappings":"mUAKMA,E,kDACJ,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IAsBRC,kBAAoB,SAACC,GACnB,IAAMC,EAAkBD,EAAEE,OAAOC,MACjC,EAAKC,SAAS,CACZH,qBA1Be,EA+BnBI,uBAAyB,SAACC,GACxB,OAAO,WACQ,SAATA,EACF,EAAKF,SAAS,CACZG,gBAAgB,IAGlB,EAAKH,SAAS,CACZH,gBAAiB,GACjBM,gBAAgB,MAxCL,EA+CnBC,0BAA4B,SAACC,GAC3B,OAAO,WACL,IAAIH,EAGFA,EADEG,EAAcC,KACT,YAEA,OAGT,IAAMC,QAAQ,CACZC,QAAS,kCAAWH,EAAcI,KAAO,WACzCC,KAAM,WACS,SAATR,EACF,EAAKS,oBAAoBN,EAAcI,MAEvC,EAAKG,eAAeP,QA/DX,EAsEnBM,oBAtEmB,uCAsEG,WAAOE,GAAP,eAAAC,EAAA,2DACF,EAAKpB,MAAMW,cAAcU,MAAK,SAAAC,GAAI,OAAIA,EAAKP,OAASI,KACxDI,SAASC,OAAS,GAFZ,uBAGlB,IAAQC,QAAQ,wFAHE,0CAMFC,YAAuBP,GANrB,OAOH,KADXQ,EANc,QAOZC,MACN,IAAQC,QAAQF,EAAIG,KACpBC,IAAeC,KAAK,qBAEpB,IAAQP,QAAQE,EAAIG,KAXF,2CAtEH,wDAqFnBZ,eArFmB,uCAqFF,WAAOe,GAAP,mBAAAb,EAAA,6DACPR,EAAaqB,EAAbrB,KAAMsB,EAAOD,EAAPC,GADC,SAEGC,YAAmBvB,EAAMsB,GAF5B,OAGE,KADXP,EAFS,QAGPC,MACN,IAAQC,QAAQF,EAAIG,KACpBC,IAAeC,KAAK,qBAEpB,IAAQP,QAAQE,EAAIG,KAPP,2CArFE,wDAiGnBM,uBAjGmB,sBAiGM,8BAAAhB,EAAA,yDACfjB,EAAoB,EAAKkC,MAAzBlC,gBADe,iEAGLmC,YAAoBnC,GAHf,OAIN,KADXwB,EAHiB,QAIfC,MACN,IAAQC,QAAQF,EAAIG,KACpBC,IAAeC,KAAK,oBACpB,EAAK1B,SAAS,CACZH,gBAAiB,GACjBM,gBAAgB,KAGlB,IAAQgB,QAAQE,EAAIG,KAZC,2CA/FvB,EAAKO,MAAQ,CACXlC,gBAAiB,GACjBM,gBAAgB,GAElB,EAAK8B,QAAU,CACb,CACEC,MAAO,2BACPC,UAAW,QAEb,CACEC,MAAO,IACPF,MAAO,eACPG,OAAQ,SAAAhC,GACN,OACE,mBAAQiC,QAAM,EAACC,QAAS,EAAKnC,0BAA0BC,GAAvD,6BAhBS,E,0CAiHnB,WACE,MAA4CmC,KAAKT,MAAzC5B,EAAR,EAAQA,eAAgBN,EAAxB,EAAwBA,gBACxB,OACE,oBAAMqC,MAAO,mBAAQhC,KAAK,UAAUqC,QAASC,KAAKvC,uBAAuB,QAA5D,kDAAsFwC,UAAU,kBAA7G,UACE,mBAAOC,UAAQ,EAACC,WAAYH,KAAK9C,MAAMW,cAAeuC,OAAO,OAAOX,QAASO,KAAKP,UAElF,mBACEC,MAAM,uCACNW,QAAS1C,EACTO,KAAM8B,KAAKV,uBACXgB,SAAUN,KAAKvC,uBAAuB,SACtC8C,OAAO,eACPC,WAAW,eANb,SAQE,mBAAOjD,MAAOF,EAAiBoD,SAAUT,KAAK7C,6B,GAhI5BuD,aAwIbzD","file":"static/js/9.19b63609.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { Card, Button, Modal, message, Table, Input } from 'antd'\r\nimport { reqAddResourcesCate, reqResourcesDeleteCate, reqDeleteResources } from '@/api'\r\nimport QcEventEmitter from '@/utils/QcEventEmitter'\r\n\r\nclass ResourcesCate extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      addResCateValue: '',\r\n      isModalVisible: false\r\n    }\r\n    this.columns = [\r\n      {\r\n        title: '分类名称',\r\n        dataIndex: 'name',\r\n      },\r\n      {\r\n        width: 200,\r\n        title: '操作',\r\n        render: resourcesCate => {\r\n          return (\r\n            <Button danger onClick={this.handleDeleteResourcesCate(resourcesCate)} >删除</Button>\r\n          )\r\n        }\r\n      },\r\n    ]\r\n  }\r\n  // 表单输入\r\n  handleInputChange = (e) => {\r\n    const addResCateValue = e.target.value\r\n    this.setState({\r\n      addResCateValue\r\n    })\r\n  }\r\n\r\n  // 处理对话框关闭\r\n  handleOpenOrCloseModal = (type) => {\r\n    return () => {\r\n      if (type === 'open') {\r\n        this.setState({\r\n          isModalVisible: true\r\n        })\r\n      } else {\r\n        this.setState({\r\n          addResCateValue: '',\r\n          isModalVisible: false\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  // 处理删除\r\n  handleDeleteResourcesCate = (resourcesCate) => {\r\n    return () => {\r\n      let type\r\n      // 判断类型 该表格下有两种类型 分类 跟 下属资源\r\n      if (resourcesCate.cate) {\r\n        type = 'resources'\r\n      } else {\r\n        type = 'cate'\r\n      }\r\n\r\n      Modal.confirm({\r\n        content: '真的要删除 ' + resourcesCate.name + ' 吗?',\r\n        onOk: () => {\r\n          if (type === 'cate') {\r\n            this.DeleteResourcesCate(resourcesCate.name)\r\n          } else {\r\n            this.DeleteResource(resourcesCate)\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n  // 删除对应资源分类\r\n  DeleteResourcesCate = async (cateName) => {\r\n    const Resources = this.props.resourcesCate.find(item => item.name === cateName)\r\n    if (Resources.children.length > 0) {\r\n      message.warning('该分类下还有资源，不能删除！')\r\n      return\r\n    }\r\n    const res = await reqResourcesDeleteCate(cateName)\r\n    if (res.code === 0) {\r\n      message.success(res.msg)\r\n      QcEventEmitter.emit('getResourcesCate')\r\n    } else {\r\n      message.warning(res.msg)\r\n    }\r\n  }\r\n  // 删除对应资源\r\n  DeleteResource = async (resource) => {\r\n    const { cate, id } = resource\r\n    const res = await reqDeleteResources(cate, id)\r\n    if (res.code === 0) {\r\n      message.success(res.msg)\r\n      QcEventEmitter.emit('getResourcesCate')\r\n    } else {\r\n      message.warning(res.msg)\r\n    }\r\n  }\r\n\r\n  // 添加资源分类\r\n  handleAddResourcesCate = async () => {\r\n    const { addResCateValue } = this.state\r\n    if (!addResCateValue) return\r\n    const res = await reqAddResourcesCate(addResCateValue)\r\n    if (res.code === 0) {\r\n      message.success(res.msg)\r\n      QcEventEmitter.emit('getResourcesCate')\r\n      this.setState({\r\n        addResCateValue: '',\r\n        isModalVisible: false\r\n      })\r\n    } else {\r\n      message.warning(res.msg)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { isModalVisible, addResCateValue } = this.state\r\n    return (\r\n      <Card title={<Button type=\"primary\" onClick={this.handleOpenOrCloseModal('open')}>添加资源分类</Button>} className=\"resources_admin\">\r\n        <Table bordered dataSource={this.props.resourcesCate} rowKey=\"name\" columns={this.columns} />\r\n\r\n        <Modal\r\n          title=\"添加资源分类\"\r\n          visible={isModalVisible}\r\n          onOk={this.handleAddResourcesCate}\r\n          onCancel={this.handleOpenOrCloseModal('close')}\r\n          okText=\"添加\"\r\n          cancelText=\"取消\"\r\n        >\r\n          <Input value={addResCateValue} onChange={this.handleInputChange} />\r\n        </Modal>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default ResourcesCate;"],"sourceRoot":""}