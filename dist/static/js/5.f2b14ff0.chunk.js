(this["webpackJsonpdocument-online"]=this["webpackJsonpdocument-online"]||[]).push([[5],{636:function(e,t,a){},643:function(e,t,a){"use strict";a.r(t);a(339);var n=a(243),r=(a(338),a(242)),s=(a(76),a(30)),c=a(34),i=a.n(c),l=(a(150),a(45)),o=a(49),u=(a(203),a(114)),d=a(24),h=a(29),b=a(26),j=a(25),m=a(0),p=(a(638),a(637)),O=(a(628),a(629)),f=(a(204),a(115)),g=a(103),x=a(250),v=(a(341),a(143)),C=a(102),U=a(337),k=a(43),y=a(88),M=a(5),w=v.a.Option,R=function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||l.b.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||l.b.error("Image must smaller than 2MB!"),t&&a},I=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var n;Object(d.a)(this,a),(n=t.call(this,e)).saveResource=Object(o.a)(i.a.mark((function e(){var t,a,r,s,c,o,u,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.imageUrl,r=t.url,s=t.name,c=t.cate,o=t.desc,s&&c&&r){e.next=4;break}return l.b.warning("\u8bf7\u586b\u5199 \u7f51\u7ad9\u5730\u5740,\u540d\u79f0,\u9009\u62e9\u5206\u7c7b"),e.abrupt("return");case 4:if(!n.isUpdate){e.next=11;break}return d=n.props.resource.id,e.next=8,Object(k.n)({imageUrl:a,url:r,name:s,cate:c,desc:o,id:d});case 8:u=e.sent,e.next=14;break;case 11:return e.next=13,Object(k.b)({imageUrl:a,url:r,name:s,cate:c,desc:o});case 13:u=e.sent;case 14:0===u.code?(l.b.success(u.msg),n.setState({imageUrl:"",url:"",name:"",cate:"",desc:""}),y.a.emit("getResourcesCate"),n.handleCloseModal()):l.b.warning(u.msg);case 15:case"end":return e.stop()}}),e)}))),n.handleChange=function(e){"uploading"!==e.file.status?"done"===e.file.status&&function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}(e.file.originFileObj,(function(e){return n.setState({imageUrl:e,loading:!1})})):n.setState({loading:!0})},n.handleInputValue=function(e){return function(t){if(t.target){var a=t.target.value;n.setState(Object(x.a)({},e,a))}else n.setState(Object(x.a)({},e,t))}},n.handleCloseModal=function(){n.setState({loading:!1,imageUrl:"",url:"",name:"",cate:"",desc:""},(function(){n.isUpdate=!1,n.props.handleCloseModal()}))};var r=e.resource;return r.name?n.state=Object(g.a)({loading:!1},r):n.state={loading:!1,imageUrl:"",url:"",name:"",cate:"",desc:""},n}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(){var e=this.props.resource;!this.isUpdate&&e.name&&e.name!==this.state.name&&(this.setState(Object(g.a)({},e)),this.isUpdate=!0)}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.imageUrl,n=e.name,r=e.desc,s=e.url,c=e.cate,i=Object(M.jsxs)("div",{children:[t?Object(M.jsx)(C.a,{}):Object(M.jsx)(U.a,{}),Object(M.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return Object(M.jsx)(u.a,{title:"\u6dfb\u52a0\u8d44\u6e90",visible:this.props.isModalVisible,onOk:this.saveResource,onCancel:this.handleCloseModal,okText:"\u6dfb\u52a0",cancelText:"\u53d6\u6d88",children:Object(M.jsxs)(O.a,Object(g.a)(Object(g.a)({},{labelCol:{span:4},wrapperCol:{span:16}}),{},{name:"\u6dfb\u52a0\u8d44\u6e90",children:[Object(M.jsx)(O.a.Item,{label:"\u7f51\u7ad9\u5730\u5740",children:Object(M.jsx)(f.a,{placeholder:"http://",value:s,onChange:this.handleInputValue("url")})}),Object(M.jsx)(O.a.Item,{label:"\u8d44\u6e90\u540d\u79f0",children:Object(M.jsx)(f.a,{value:n,onChange:this.handleInputValue("name")})}),Object(M.jsx)(O.a.Item,{label:"\u63cf\u8ff0",children:Object(M.jsx)(f.a,{value:r,onChange:this.handleInputValue("desc")})}),Object(M.jsx)(O.a.Item,{label:"\u56fe\u6807",children:Object(M.jsx)(p.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:R,onChange:this.handleChange,children:a?Object(M.jsx)("img",{src:a,alt:"avatar",style:{width:"100%"}}):i})}),Object(M.jsx)(O.a.Item,{label:"\u56fe\u6807Src",children:Object(M.jsx)(f.a,{value:a,onChange:this.handleInputValue("imageUrl")})}),Object(M.jsx)(O.a.Item,{label:"\u8d44\u6e90\u5206\u7c7b",children:Object(M.jsx)(v.a,{defaultValue:c,placeholder:"\u9009\u62e9\u8d44\u6e90\u5206\u7c7b",style:{width:120},onChange:this.handleInputValue("cate"),children:this.props.resourcesCate.map((function(e){return Object(M.jsx)(w,{value:e.name,children:e.name},e.name)}))},Math.random())})]}))})}}]),a}(m.PureComponent),V=a(627),S=a(624);a(636);function N(){var e=255*Math.random(),t=255*Math.random(),a=255*Math.random(),n=1*Math.random();return"rgba(".concat(e,", ").concat(t,", ").concat(a,",").concat(n,")")}var D=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).handleDeleteResource=function(e){return function(){u.a.confirm({content:"\u4f60\u771f\u7684\u8981\u5220\u9664 "+e.name+" \u5417?",onOk:function(){var t=Object(o.a)(i.a.mark((function t(){var a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.cate,n=e.id,t.next=3,Object(k.f)(a,n);case 3:0===(r=t.sent).code?(l.b.success(r.msg),y.a.emit("getResourcesCate")):l.b.warning(r.msg);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})}},n.handleUpdateResource=function(e){return function(){n.setState({isModalVisible:!0,currentResource:e})}},n.handleAddResources=function(){n.setState({isModalVisible:!0,currentResource:{}})},n.handleCloseModal=function(){n.setState({isModalVisible:!1,currentResource:{}})},n.state={isModalVisible:!1,currentResource:{}},n.columns=[{title:"\u7f51\u7ad9\u540d\u79f0",render:function(e){return Object(M.jsx)("div",{className:"resource_img",children:e.imageUrl?Object(M.jsx)("img",{src:e.imageUrl,alt:""}):Object(M.jsx)("div",{style:{background:N()},children:e.name})})}},{title:"\u7f51\u7ad9\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u7f51\u7ad9\u63cf\u8ff0",dataIndex:"desc",key:"desc"},{width:180,title:"\u64cd\u4f5c",render:function(e){return Object(M.jsxs)("div",{className:"resource_update_btn",children:[Object(M.jsx)(s.a,{type:"primary",size:"small",icon:Object(M.jsx)(V.a,{}),onClick:n.handleUpdateResource(e),children:"\u7f16\u8f91"})," \xa0",Object(M.jsx)(s.a,{danger:!0,size:"small",icon:Object(M.jsx)(S.a,{}),onClick:n.handleDeleteResource(e),children:"\u5220\u9664"})]})}}],n}return Object(h.a)(a,[{key:"render",value:function(){var e=this.state,t=e.isModalVisible,a=e.currentResource,c=this.props.match.params.name,i=this.props.resourcesCate.find((function(e){return e.name===c}));return Object(M.jsxs)(n.a,{title:Object(M.jsx)(s.a,{type:"primary",onClick:this.handleAddResources,children:"\u6dfb\u52a0\u8d44\u6e90"}),className:"resources_admin",children:[Object(M.jsx)(r.a,{bordered:!0,dataSource:i&&i.children,rowKey:"id",columns:this.columns}),Object(M.jsx)(I,{isModalVisible:t,handleCloseModal:this.handleCloseModal,resourcesCate:this.props.resourcesCate,resource:a})]})}}]),a}(m.Component);t.default=D}}]);
//# sourceMappingURL=5.f2b14ff0.chunk.js.map